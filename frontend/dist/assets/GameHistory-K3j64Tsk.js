import{A as S,r as p,l as C,j as e,H,B as x,i as T,k}from"./index-Cqv-lK9G.js";import{u as A}from"./useMutation-C-ZlyFRL.js";import{b as P,c as B}from"./adminApi-DG7ULGGd.js";import{I as G}from"./input-DXxRHlHz.js";import{T as I,a as D,b as m,c as l,d as E,e as t}from"./table-BliYtvlZ.js";import{S as q}from"./skeleton-pxI1GVYg.js";import{T as F}from"./trash-2-DC3iqYzi.js";import{A as O,a as Q}from"./arrow-up-DgReTZph.js";const c=({columnId:d,label:j,sorting:h,onSort:a})=>e.jsxs(x,{variant:"ghost",onClick:()=>a(d),className:"pl-0 hover:bg-transparent",children:[j,h.sortBy===d&&(h.order==="asc"?e.jsx(O,{className:"ml-2 h-4 w-4"}):e.jsx(Q,{className:"ml-2 h-4 w-4"}))]});function J(){const d=S(),[j,h]=p.useState(!1),[a,u]=p.useState({page:1,limit:10,sortBy:"id",order:"desc",game:"",username:""}),{data:n,isLoading:y,isError:b,error:f}=C({queryKey:["gameHistory",a],queryFn:()=>B(a),keepPreviousData:!0}),N=A({mutationFn:P,onSuccess:()=>{d.invalidateQueries(["gameHistory",a])},onError:s=>{alert(s.message)}}),i=s=>{u(r=>({...r,page:1,sortBy:s,order:r.sortBy===s&&r.order==="asc"?"desc":"asc"}))},g=(s,r)=>{u(w=>({...w,page:1,[s]:r}))},v=(n==null?void 0:n.data)||[],o=n==null?void 0:n.pagination;return e.jsxs("div",{className:"min-h-screen bg-black text-white p-6 pt-24",children:[e.jsxs(H,{children:[e.jsx("title",{children:"Game History - Ripground Admin"}),e.jsx("meta",{name:"description",content:"View and manage game history entries."})]}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Game History"}),e.jsx(G,{placeholder:"Search by username...",className:"w-full md:w-64 bg-gray-900 border-gray-700 text-gray-100",value:a.username,onChange:s=>g("username",s.target.value)})]}),e.jsx("div",{className:"bg-natural-800 rounded-lg border border-gray-800 overflow-hidden",children:e.jsxs(I,{children:[e.jsx(D,{children:e.jsxs(m,{className:"border-gray-800 hover:bg-transparent",children:[e.jsx(l,{children:e.jsx(c,{columnId:"id",label:"ID",sorting:a,onSort:i})}),e.jsx(l,{children:e.jsx(c,{columnId:"username",label:"Username",sorting:a,onSort:i})}),e.jsx(l,{children:e.jsx(c,{columnId:"game",label:"Game",sorting:a,onSort:i})}),e.jsx(l,{children:e.jsx(c,{columnId:"time",label:"Time",sorting:a,onSort:i})}),e.jsx(l,{children:e.jsx(c,{columnId:"played_at",label:"Played At",sorting:a,onSort:i})}),e.jsx(l,{className:"w-20",children:"Actions"})]})}),e.jsx(E,{children:y?Array.from({length:a.limit}).map((s,r)=>e.jsx(m,{children:e.jsx(t,{colSpan:6,children:e.jsx(q,{className:"h-8 w-full"})})},r)):b?e.jsx(m,{children:e.jsx(t,{colSpan:6,className:"text-center text-red-500 py-10",children:f.message})}):v.map(s=>e.jsxs(m,{className:"border-gray-800 hover:bg-gray-800/30",children:[e.jsx(t,{children:s.id}),e.jsx(t,{children:s.username}),e.jsx("tableCell",{children:s.game_title}),e.jsx(t,{children:s.time}),e.jsx(t,{children:new Date(s.created_at).toLocaleString()}),e.jsx(t,{children:e.jsx(x,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300",onClick:()=>N.mutate(s.id),children:e.jsx(F,{className:"h-4 w-4"})})})]},s.id))})]})}),o&&o.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Page ",o.currentPage," of ",o.totalPages]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",size:"sm",onClick:()=>g("page",a.page-1),disabled:a.page===1,children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>g("page",a.page+1),disabled:a.page===o.totalPages,children:e.jsx(k,{className:"h-4 w-4"})})]})]})]})]})}export{J as default};
